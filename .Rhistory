legend.title = element_text(size = 12),
legend.title.align = 0.5)
)
})
}
shinyApp(ui = ui, server = server)
ui <- fluidPage(theme = shinytheme("flatly"),
useShinyFeedback(),
titlePanel("Opioid Overdose Rate and Unhoused Populations"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "year",
label = "Choose a Year of Interest.",
choices = c("2020", "2021", "2022"),
selected = NULL),
h5("Data: IL Dept of Public Health, ACS, Chicago Point-in-Time Survey")
),
mainPanel(
tabsetPanel(
tabPanel(title = "Opioid Rates", plotlyOutput("plot"))
)
)))
##shiny
#manipulate year in drop down to select which column in opioid dataframe
server <- function(input, output) {
##Plot 2022 RATE
output$plot <- renderPlotly({
ggplotly(ggplot() +
geom_sf(data = zip_chi_shape) +
geom_sf(data = filter(opioid_shape_wide, year == "2022"), aes(fill = overdose_rate), color = NA) +
labs(title = "Opioid Overdose Rate (Nonfatal and Fatal Per 10,000 Ppl)",
subtitle = "By Zip in 2022. Dot Size Correlated W/ High-Density Unhoused Pop.") +
scale_fill_viridis(name="Opioid Overdose Rate", option = "magma", trans = "reverse",
breaks = pretty_breaks(n = 5)) +
geom_point(data = unhoused_locations, aes(x = Longitude, y = Latitude,
size = Responses,),
color = "#8c62aa",alpha = 0.7) +
guides(size = FALSE) +
theme_map() +
theme(
plot.title = element_text(hjust = 0, size= 13),
plot.subtitle = element_text(size = 10, hjust = 0), #subtitle not showing
legend.title = element_text(size = 12),
legend.title.align = 0.5)
)
})
}
shinyApp(ui = ui, server = server)
View(opioid_shape_wide)
ui <- fluidPage(theme = shinytheme("flatly"),
useShinyFeedback(),
titlePanel("Opioid Overdose Rate and Unhoused Populations"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "year",
label = "Choose a Year of Interest.",
choices = c("2020", "2021", "2022"),
selected = NULL),
h5("Data: IL Dept of Public Health, ACS, Chicago Point-in-Time Survey")
),
mainPanel(
tabsetPanel(
tabPanel(title = "Opioid Rates", plotlyOutput("plot"))
)
)))
##shiny
#manipulate year in drop down to select which column in opioid dataframe
server <- function(input, output) {
##Plot 2022 RATE
output$plot <- renderPlotly({
ggplotly(ggplot() +
geom_sf(data = zip_chi_shape) +
geom_sf(data = filter(opioid_shape_wide, year == "2022"), aes(fill = Overdose_Rate), color = NA) +
labs(title = "Opioid Overdose Rate (Nonfatal and Fatal Per 10,000 Ppl)",
subtitle = "By Zip in 2022. Dot Size Correlated W/ High-Density Unhoused Pop.") +
scale_fill_viridis(name="Opioid Overdose Rate", option = "magma", trans = "reverse",
breaks = pretty_breaks(n = 5)) +
geom_point(data = unhoused_locations, aes(x = Longitude, y = Latitude,
size = Responses,),
color = "#8c62aa",alpha = 0.7) +
guides(size = FALSE) +
theme_map() +
theme(
plot.title = element_text(hjust = 0, size= 13),
plot.subtitle = element_text(size = 10, hjust = 0), #subtitle not showing
legend.title = element_text(size = 12),
legend.title.align = 0.5)
)
})
}
shinyApp(ui = ui, server = server)
ui <- fluidPage(theme = shinytheme("flatly"),
useShinyFeedback(),
titlePanel("Opioid Overdose Rate and Unhoused Populations"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "year",
label = "Choose a Year of Interest.",
choices = c("2020", "2021", "2022"),
selected = NULL),
h5("Data: IL Dept of Public Health, ACS, Chicago Point-in-Time Survey")
),
mainPanel(
tabsetPanel(
tabPanel(title = "Opioid Rates", plotlyOutput("plot"))
)
)))
##shiny
#manipulate year in drop down to select which column in opioid dataframe
server <- function(input, output) {
##Plot 2022 RATE
output$plot <- renderPlotly({
ggplotly(ggplot() +
geom_sf(data = zip_chi_shape) +
geom_sf(data = filter(opioid_shape_wide, year == input$year), aes(fill = Overdose_Rate), color = NA) +
labs(title = "Opioid Overdose Rate (Nonfatal and Fatal Per 10,000 Ppl)",
subtitle = "By Zip in 2022. Dot Size Correlated W/ High-Density Unhoused Pop.") +
scale_fill_viridis(name="Opioid Overdose Rate", option = "magma", trans = "reverse",
breaks = pretty_breaks(n = 5)) +
geom_point(data = unhoused_locations, aes(x = Longitude, y = Latitude,
size = Responses,),
color = "#8c62aa",alpha = 0.7) +
guides(size = FALSE) +
theme_map() +
theme(
plot.title = element_text(hjust = 0, size= 13),
plot.subtitle = element_text(size = 10, hjust = 0), #subtitle not showing
legend.title = element_text(size = 12),
legend.title.align = 0.5)
)
})
}
shinyApp(ui = ui, server = server)
ui <- fluidPage(theme = shinytheme("flatly"),
useShinyFeedback(),
titlePanel("Opioid Overdose Rate and Unhoused Populations"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "year",
label = "Choose a Year of Interest.",
choices = c("2020", "2021", "2022"),
selected = NULL),
h5("Data: IL Dept of Public Health, ACS, Chicago Point-in-Time Survey")
),
mainPanel(
tabsetPanel(
tabPanel(title = "Opioid Rates", plotlyOutput("plot"))
)
)))
##shiny
#manipulate year in drop down to select which column in opioid dataframe
server <- function(input, output) {
##Plot 2022 RATE
output$plot <- renderPlotly({
ggplotly(ggplot() +
geom_sf(data = zip_chi_shape) +
geom_sf(data = filter(opioid_shape_wide, year == !!sym(input$year)), aes(fill = Overdose_Rate), color = NA) +
labs(title = "Opioid Overdose Rate (Nonfatal and Fatal Per 10,000 Ppl)",
subtitle = paste("By Zip in", input$year,". Dot Size Correlated W/ High-Density Unhoused Pop.") +
scale_fill_viridis(name="Opioid Overdose Rate", option = "magma", trans = "reverse",
breaks = pretty_breaks(n = 5)) +
geom_point(data = unhoused_locations, aes(x = Longitude, y = Latitude,
size = Responses,),
color = "#8c62aa",alpha = 0.7) +
guides(size = FALSE) +
theme_map() +
theme(
plot.title = element_text(hjust = 0, size= 13),
plot.subtitle = element_text(size = 10, hjust = 0), #subtitle not showing
legend.title = element_text(size = 12),
legend.title.align = 0.5)
))
})
}
shinyApp(ui = ui, server = server)
View(opioid_shape_wide)
View(opioid_shape_wide)
ui <- fluidPage(theme = shinytheme("flatly"),
useShinyFeedback(),
titlePanel("Opioid Overdose Rate and Unhoused Populations"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "year",
label = "Choose a Year of Interest.",
choices = c("2020", "2021", "2022"),
selected = NULL),
h5("Data: IL Dept of Public Health, ACS, Chicago Point-in-Time Survey")
),
mainPanel(
tabsetPanel(
tabPanel(title = "Opioid Rates", plotlyOutput("plot"))
)
)))
##shiny
#manipulate year in drop down to select which column in opioid dataframe
server <- function(input, output) {
##Plot 2022 RATE
output$plot <- renderPlotly({
ggplotly(ggplot() +
geom_sf(data = zip_chi_shape) +
geom_sf(data = filter(opioid_shape_wide, year == input$year), aes(fill = Overdose_Rate), color = NA) +
labs(title = "Opioid Overdose Rate (Nonfatal and Fatal Per 10,000 Ppl)",
subtitle = paste("By Zip in", input$year,".", " ", "Dot Size Correlated W/ High-Density Unhoused Pop.") +
scale_fill_viridis(name="Opioid Overdose Rate", option = "magma", trans = "reverse",
breaks = pretty_breaks(n = 5)) +
geom_point(data = unhoused_locations, aes(x = Longitude, y = Latitude,
size = Responses,),
color = "#8c62aa",alpha = 0.7) +
guides(size = FALSE) +
theme_map() +
theme(
plot.title = element_text(hjust = 0, size= 13),
plot.subtitle = element_text(size = 10, hjust = 0), #subtitle not showing
legend.title = element_text(size = 12),
legend.title.align = 0.5)
))
})
}
shinyApp(ui = ui, server = server)
ui <- fluidPage(theme = shinytheme("flatly"),
useShinyFeedback(),
titlePanel("Opioid Overdose Rate and Unhoused Populations"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "year",
label = "Choose a Year of Interest.",
choices = c("2020", "2021", "2022"),
selected = NULL),
h5("Data: IL Dept of Public Health, ACS, Chicago Point-in-Time Survey")
),
mainPanel(
tabsetPanel(
tabPanel(title = "Opioid Rates", plotOutput("plot"))
)
)))
##shiny
#manipulate year in drop down to select which column in opioid dataframe
server <- function(input, output) {
##Plot 2022 RATE
output$plot <- renderPlot({
ggplotly(ggplot() +
geom_sf(data = zip_chi_shape) +
geom_sf(data = filter(opioid_shape_wide, year == input$year), aes(fill = Overdose_Rate), color = NA) +
labs(title = "Opioid Overdose Rate (Nonfatal and Fatal Per 10,000 Ppl)",
subtitle = paste("By Zip in", input$year,".", " ", "Dot Size Correlated W/ High-Density Unhoused Pop.") +
scale_fill_viridis(name="Opioid Overdose Rate", option = "magma", trans = "reverse",
breaks = pretty_breaks(n = 5)) +
geom_point(data = unhoused_locations, aes(x = Longitude, y = Latitude,
size = Responses,),
color = "#8c62aa",alpha = 0.7) +
guides(size = FALSE) +
theme_map() +
theme(
plot.title = element_text(hjust = 0, size= 13),
plot.subtitle = element_text(size = 10, hjust = 0), #subtitle not showing
legend.title = element_text(size = 12),
legend.title.align = 0.5)
))
})
}
shinyApp(ui = ui, server = server)
ui <- fluidPage(theme = shinytheme("flatly"),
useShinyFeedback(),
titlePanel("Opioid Overdose Rate and Unhoused Populations"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "year",
label = "Choose a Year of Interest.",
choices = c("2020", "2021", "2022"),
selected = NULL),
h5("Data: IL Dept of Public Health, ACS, Chicago Point-in-Time Survey")
),
mainPanel(
tabsetPanel(
tabPanel(title = "Opioid Rates", plotOutput("plot"))
)
)))
##shiny
#manipulate year in drop down to select which column in opioid dataframe
server <- function(input, output) {
##Plot 2022 RATE
output$plot <- renderPlot({
ggplotly(ggplot() +
geom_sf(data = zip_chi_shape) +
geom_sf(data = filter(opioid_shape_wide, year == !!sym(input$year)), aes(fill = Overdose_Rate), color = NA) +
labs(title = "Opioid Overdose Rate (Nonfatal and Fatal Per 10,000 Ppl)",
subtitle = paste("By Zip in", !!sym(input$year),".", " ", "Dot Size Correlated W/ High-Density Unhoused Pop.") +
scale_fill_viridis(name="Opioid Overdose Rate", option = "magma", trans = "reverse",
breaks = pretty_breaks(n = 5)) +
geom_point(data = unhoused_locations, aes(x = Longitude, y = Latitude,
size = Responses,),
color = "#8c62aa",alpha = 0.7) +
guides(size = FALSE) +
theme_map() +
theme(
plot.title = element_text(hjust = 0, size= 13),
plot.subtitle = element_text(size = 10, hjust = 0), #subtitle not showing
legend.title = element_text(size = 12),
legend.title.align = 0.5)
))
})
}
shinyApp(ui = ui, server = server)
opioid_shape_wide <- opioid_shape %>%
select(zip, geometry, overdose_rate_2022, overdose_rate_2021, overdose_rate_2020) %>%
rename(`2022` = overdose_rate_2022,
`2021` = overdose_rate_2021,
`2020` = overdose_rate_2020) %>%
pivot_longer(cols = starts_with("20"), names_to = "Year", values_to = "Overdose_Rate")
ui <- fluidPage(theme = shinytheme("flatly"),
useShinyFeedback(),
titlePanel("Opioid Overdose Rate and Unhoused Populations"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "year",
label = "Choose a Year of Interest.",
choices = c("2020", "2021", "2022"),
selected = NULL),
h5("Data: IL Dept of Public Health, ACS, Chicago Point-in-Time Survey")
),
mainPanel(
tabsetPanel(
tabPanel(title = "Opioid Rates", plotOutput("plot"))
)
)))
##shiny
#manipulate year in drop down to select which column in opioid dataframe
server <- function(input, output) {
##Plot 2022 RATE
output$plot <- renderPlot({
ggplotly(ggplot() +
geom_sf(data = zip_chi_shape) +
geom_sf(data = filter(opioid_shape_wide, Year == !!sym(input$year)), aes(fill = Overdose_Rate), color = NA) +
labs(title = "Opioid Overdose Rate (Nonfatal and Fatal Per 10,000 Ppl)",
subtitle = paste("By Zip in", !!sym(input$year),".", " ", "Dot Size Correlated W/ High-Density Unhoused Pop.") +
scale_fill_viridis(name="Opioid Overdose Rate", option = "magma", trans = "reverse",
breaks = pretty_breaks(n = 5)) +
geom_point(data = unhoused_locations, aes(x = Longitude, y = Latitude,
size = Responses,),
color = "#8c62aa",alpha = 0.7) +
guides(size = FALSE) +
theme_map() +
theme(
plot.title = element_text(hjust = 0, size= 13),
plot.subtitle = element_text(size = 10, hjust = 0), #subtitle not showing
legend.title = element_text(size = 12),
legend.title.align = 0.5)
))
})
ui <- fluidPage(theme = shinytheme("flatly"),
useShinyFeedback(),
titlePanel("Opioid Overdose Rate and Unhoused Populations"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "year",
label = "Choose a Year of Interest.",
choices = c("2020", "2021", "2022"),
selected = NULL),
h5("Data: IL Dept of Public Health, ACS, Chicago Point-in-Time Survey")
),
mainPanel(
tabsetPanel(
tabPanel(title = "Opioid Rates", plotOutput("plot"))
)
)))
##shiny
#manipulate year in drop down to select which column in opioid dataframe
server <- function(input, output) {
##Plot 2022 RATE
output$plot <- renderPlot({
ggplotly(ggplot() +
geom_sf(data = zip_chi_shape) +
geom_sf(data = filter(opioid_shape_wide, Year == !!sym(input$year)), aes(fill = Overdose_Rate), color = NA) +
labs(title = "Opioid Overdose Rate (Nonfatal and Fatal Per 10,000 Ppl)",
subtitle = paste("By Zip in", !!sym(input$year),".", " ", "Dot Size Correlated W/ High-Density Unhoused Pop.") +
scale_fill_viridis(name="Opioid Overdose Rate", option = "magma", trans = "reverse",
breaks = pretty_breaks(n = 5)) +
geom_point(data = unhoused_locations, aes(x = Longitude, y = Latitude,
size = Responses,),
color = "#8c62aa",alpha = 0.7) +
guides(size = FALSE) +
theme_map() +
theme(
plot.title = element_text(hjust = 0, size= 13),
plot.subtitle = element_text(size = 10, hjust = 0), #subtitle not showing
legend.title = element_text(size = 12),
legend.title.align = 0.5)
))
})
}
shinyApp(ui = ui, server = server)
##APP
ui <- fluidPage(theme = shinytheme("flatly"),
useShinyFeedback(),
titlePanel("Opioid Overdose Rate and Unhoused Populations"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "year",
label = "Choose a Year of Interest.",
choices = c("2020", "2021", "2022"),
selected = NULL),
h5("Data: IL Dept of Public Health, ACS, Chicago Point-in-Time Survey")
),
mainPanel(
tabsetPanel(
tabPanel(title = "Opioid Rates", plotOutput("plot"))
)
)))
##shiny
#manipulate year in drop down to select which column in opioid dataframe
server <- function(input, output) {
##Plot 2022 RATE
output$plot <- renderPlot({
ggplotly(ggplot() +
geom_sf(data = zip_chi_shape) +
geom_sf(data = filter(opioid_shape_wide, Year == !!sym(input$year)), aes(fill = Overdose_Rate), color = NA) +
labs(title = "Opioid Overdose Rate (Nonfatal and Fatal Per 10,000 Ppl)",
subtitle = paste("By Zip in", !!sym(input$year),".", " ", "Dot Size Correlated W/ High-Density Unhoused Pop.") +
scale_fill_viridis(name="Opioid Overdose Rate", option = "magma", trans = "reverse",
breaks = pretty_breaks(n = 5)) +
geom_point(data = unhoused_locations, aes(x = Longitude, y = Latitude,
size = Responses,),
color = "#8c62aa",alpha = 0.7) +
guides(size = FALSE) +
theme_map() +
theme(
plot.title = element_text(hjust = 0, size= 13),
plot.subtitle = element_text(size = 10, hjust = 0), #subtitle not showing
legend.title = element_text(size = 12),
legend.title.align = 0.5)
))
})
}
shinyApp(ui = ui, server = server)
View(opioid_shape_wide)
feb_url <- "https://gov.texas.gov/news/archive/2024/02"
response <- read_html(feb_url)
library(tidytext)
library(textdata)
library(tidyverse)
library(sentimentr)
library(udpipe)
library(SnowballC)
library(rvest)
library(stargazer)
#Webscrape
#I did 2024 by itself since it only had 2 month and it seemed too much of a hasle to code seperate breaks just for 2024 #sue me
###2024####
##Feb
feb_url <- "https://gov.texas.gov/news/archive/2024/02"
response <- read_html(feb_url)
title <- response %>%
html_elements("h3.textTransform-none.h5 a") %>%
html_text(trim = TRUE)
link <- response %>%
html_elements("a.readMore") %>%
html_attr("href")
date <- response %>%
html_elements("div.date.date--horiz") %>%
html_text()
# Cleaning up and putting into dataframe
df_02_2024 <- tibble(title, date, link)
##January
jan_url <- "https://gov.texas.gov/news/archive/2024/01"
response <- read_html(jan_url)
title <- response %>%
html_elements("h3.textTransform-none.h5 a") %>%
html_text(trim = TRUE)
link <- response %>%
html_elements("a.readMore") %>%
html_attr("href")
date <- response %>%
html_elements("div.date.date--horiz") %>%
html_text()
# Cleaning up and putting into dataframe
df_01_2024 <- tibble(title, date, link)
df_2024 <- rbind(df_01_2024,df_02_2024)
df_2024 <- df_2024 %>%
mutate(year = 2024) %>%
select(year,title,date,link)
#### Everything else ####
df_texas <- tibble()
for (i in c(2023,2022,2021)) {
base_url <- paste0("https://gov.texas.gov/news/archive/", i, "/")
for (month in 1:12) {
# Ensure the month is formatted with two digits
formatted_month <- sprintf("%02d", month)
# Construct the URL with the correctly formatted month
url <- paste0(base_url, formatted_month)
response <- read_html(url)
title <- response %>%
html_elements("h3.textTransform-none.h5 a") %>%
html_text(trim = TRUE)
link <- response %>%
html_elements("a.readMore") %>%
html_attr("href")
date <- response %>%
html_elements("div.date.date--horiz") %>%
html_text()
# Only create a dataframe if there's data to add
if (length(title) > 0 && length(date) > 0 && length(link) > 0) {
temp_df <- tibble(year = rep(i, length(title)), title, date, link)
df_texas <- bind_rows(df_texas, temp_df)
}
}
# Polite scraping: pause between requests
Sys.sleep(time = 1)
}
df_texas <- rbind(df_2024,df_texas)
filtered_df <- df_texas %>%
filter(str_detect(title, "Operation Lone Star"))
View(filtered_df)
